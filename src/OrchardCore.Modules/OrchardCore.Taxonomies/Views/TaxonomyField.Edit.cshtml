@model OrchardCore.Taxonomies.ViewModels.EditTaxonomyFieldViewModel
@using OrchardCore.Taxonomies.Settings;
@using OrchardCore.ContentManagement.Metadata.Models

@{
    var settings = Model.PartFieldDefinition.Settings.ToObject<TaxonomyFieldSettings>();
    int previousLevel = -1;
}

<label>@Model.PartFieldDefinition.DisplayName()</label>
    
@if (!String.IsNullOrEmpty(settings.Hint))
{
    <span class="hint">@T["â€” {0}", settings.Hint]</span>
}

@if (Model.Taxonomy == null)
{
    <div class="alert alert-danger" role="alert">
        @T["The taxonomy could not be found. Please check the settings for this field."]
    </div>
}
<fieldset class="form-group">

@for (var i = 0; i < Model.TermEntries.Count; i++)
{
    var entry = Model.TermEntries[i];
    var term = entry.Term;

    if (entry.Level == previousLevel + 1)
    {
        WriteLiteral("<div class=\"pl-3\">");
    }

    <div class="form-check">
        <input asp-for="@Model.TermEntries[i].Selected" type="checkbox" /> 
        <label class="form-check-label" asp-for="@Model.TermEntries[i].Selected">
            @term
        </label>
        <input asp-for="@Model.TermEntries[i].ContentItemId" type="hidden" /> 
    </div>

    for (var e = entry.Level; e <= previousLevel; e++)
    {
        WriteLiteral("</div>");
    }

    previousLevel = entry.Level;
}
</fieldset>